FROM amazonlinux:2022
 ARG USER_NAME
 ARG USER_ID
 ARG GROUP_ID
 RUN echo "USER_NAME:USER_ID:GROUP_ID $USER_NAME:$USER_ID:$GROUP_ID"
# Housekeeping, fail fast before we do any downloads
#For sanity when trying to debug paths
#RUN dnf -y install which  

RUN echo "groupadd --gid $GROUP_ID user"
RUN groupadd --gid $GROUP_ID user; exit 0
RUN echo "adduser --disabled-password --gecos '' --uid $USER_ID --gid $GROUP_ID $USER_NAME"
RUN adduser --uid $USER_ID --gid $GROUP_ID $USER_NAME; exit 0

 RUN echo "$USER_NAME:$USER_NAME" | chpasswd
 RUN usermod -aG wheel $USER_NAME
# RUN useradd $USER_NAME sudo
 RUN echo '----->'
 RUN echo 'root:Docker!' | chpasswd

# We install some useful packages
 RUN dnf update -qq
 RUN dnf -y install which tzdata gnuplot
 RUN dnf install -y vim ninja-build valgrind golang curl llvm gdb  sudo pip python  wget cmake g++ git   ruby python3-pip  boost  qpdf 
 RUN echo python3 --version
 
RUN  pip3 install ipython

# Moar compilers
# RUN dnf install -y clang++-6
# RUN dnf install -y clang++-7
# RUN dnf install -y clang++-8
# RUN dnf install -y clang++-9
# RUN dnf install -y clang++-10
# RUN dnf install -y clang++-11
# RUN dnf install -y g++-7 g++-8 g++-9 g++-10
#RUN dnf install -y ruby

 
 ENV TERM xterm-256color
 USER $USER_NAME

 RUN gcc --version
 RUN cmake --version
 RUN python3 --version
 RUN pip3 --version
 RUN go version
